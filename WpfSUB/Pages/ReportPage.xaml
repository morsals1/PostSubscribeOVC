<Page x:Class="WpfSUB.Pages.ReportPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Отчеты">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10">
            <Button Content="Назад" Click="Back_Click" Margin="5" Width="80"/>
            <Button Content="Сформировать" Click="GenerateReport_Click" Margin="5" Width="150"/>
            <Button Content="Экспорт" Click="ExportToExcel_Click" Margin="5" Width="120"/>
            <Button Content="Очистить" Click="ClearReport_Click" Margin="5" Width="80"/>
        </StackPanel>

        <!-- Блок с расширенными фильтрами -->
        <Border Grid.Row="1" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="10" Margin="10,0,10,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Строка 1: Тип отчета и период -->
                <Label Grid.Row="0" Grid.Column="0" Content="Тип отчета:" Margin="0,0,10,5"/>
                <ComboBox Grid.Row="0" Grid.Column="1" x:Name="ReportTypeComboBox" 
                          SelectionChanged="ReportTypeComboBox_SelectionChanged" Margin="0,0,20,5">
                    <ComboBoxItem Content="Прайс-лист изданий"/>
                    <ComboBoxItem Content="Активные подписки"/>
                    <ComboBoxItem Content="Подписки к оплате"/>
                    <ComboBoxItem Content="Заказ в типографию"/>
                    <ComboBoxItem Content="Квитанции платежей"/>
                    <ComboBoxItem Content="Статистика клиентов"/>
                    <ComboBoxItem Content="Статистика изданий"/>
                    <ComboBoxItem Content="Подписки по дням/неделям/месяцам"/>
                    <ComboBoxItem Content="Платежи по дням/неделям/месяцам"/>
                    <ComboBoxItem Content="Клиенты по регионам"/>
                </ComboBox>

                <Label Name="PeriodByLabel" Grid.Row="0" Grid.Column="2" Content="Период:" Margin="0,0,10,5"/>
                <ComboBox Grid.Row="0" Grid.Column="3" 
                          x:Name="PeriodComboBox" 
                          SelectionChanged="PeriodComboBox_SelectionChanged" Margin="0,0,0,5">
                    <ComboBoxItem Content="Сегодня"/>
                    <ComboBoxItem Content="Вчера"/>
                    <ComboBoxItem Content="Текущая неделя"/>
                    <ComboBoxItem Content="Текущий месяц"/>
                    <ComboBoxItem Content="Прошлый месяц"/>
                    <ComboBoxItem Content="Произвольный период"/>
                </ComboBox>

                <!-- Строка 2: Дополнительные фильтры -->
                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" 
                            x:Name="AdditionalFiltersPanel" Orientation="Horizontal" 
                            Margin="0,10,0,5">
                </StackPanel>

                <!-- Строка 3: Группировка и сортировка -->
                <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" 
                            Orientation="Horizontal" Margin="0,5,0,0">

                    <Label Content="Группировать по:" Margin="0,0,10,0" VerticalAlignment="Center"/>
                    <ComboBox x:Name="GroupByComboBox" Width="120" Margin="0,0,20,0"
                              SelectionChanged="GroupByComboBox_SelectionChanged">
                        <ComboBoxItem Content="День"/>
                        <ComboBoxItem Content="Неделя"/>
                        <ComboBoxItem Content="Месяц"/>
                        <ComboBoxItem Content="Год"/>
                        <ComboBoxItem Content="Категория"/>
                        <ComboBoxItem Content="Статус"/>
                        <ComboBoxItem Content="Нет"/>
                    </ComboBox>

                    <Label Name="SortByLabel" Content="Сортировка:" Margin="0,0,10,0" VerticalAlignment="Center"/>
                    <ComboBox x:Name="SortByComboBox" Width="150">
                        <ComboBoxItem Content="По дате (убыв.)"/>
                        <ComboBoxItem Content="По дате (возр.)"/>
                        <ComboBoxItem Content="По сумме (убыв.)"/>
                        <ComboBoxItem Content="По сумме (возр.)"/>
                        <ComboBoxItem Content="По количеству (убыв.)"/>
                    </ComboBox>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Результаты отчета -->
        <Border Grid.Row="2" Margin="10" BorderBrush="#E0E0E0" BorderThickness="1">
            <DockPanel>
                <Border DockPanel.Dock="Top" Background="#F5F5F5" Padding="10" 
                        BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
                    <StackPanel>
                        <TextBlock x:Name="ReportTitleText" Text="Отчет" FontSize="16" FontWeight="Bold"/>
                        <TextBlock x:Name="ReportInfoText" Text="Выберите тип отчета и период" 
                                 Margin="0,5,0,0" Foreground="#666"/>
                    </StackPanel>
                </Border>

                <ScrollViewer>
                    <StackPanel x:Name="ReportContent" Margin="20">
                        <DataGrid x:Name="ReportDataGrid" AutoGenerateColumns="True" 
                                  IsReadOnly="True" SelectionMode="Single"
                                  CanUserAddRows="False" CanUserDeleteRows="False"
                                  MinHeight="400" CanUserSortColumns="True"
                                  AlternatingRowBackground="#F9F9F9"/>

                        <!-- Блок с итогами -->
                        <Border Margin="0,20,0,0" Padding="15" Background="#E8F5E8" 
                                BorderBrush="#C8E6C9" BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="Итоги отчета:" FontWeight="Bold" FontSize="14"/>
                                <TextBlock x:Name="SummaryText" Margin="0,10,0,0" TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </DockPanel>
        </Border>
    </Grid>
</Page>